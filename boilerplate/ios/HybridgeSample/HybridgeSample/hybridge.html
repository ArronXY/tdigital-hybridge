<html>
<head>
  <title>Hybridge Boilerplate</title>
  <link rel="stylesheet" href='flip.css'></link>
  <script src='http://requirejs.org/docs/release/2.1.9/minified/require.js'></script>
  <script type='text/javascript'>
    require.config({
      paths: {
        'jquery' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min',
        'hybridge' : 'https://raw.githubusercontent.com/telefonicaid/tdigital-hybridge/develop/js/hybridge'
      },
      waitSeconds: 30
    });
  </script>
</head>
<body>

  <h1>Featuring... The HyBridge!!!</h1>

  <button id='button' data-label='ola ke ase &lt;3'></button>

  <h3 id='message'></h3>

<img src='http://www.trbimg.com/img-51f05fbb/turbine/la-fg-wn-pope-francis-drugs-20130724-001/600/600x407'>
<img src='http://gdb.rferl.org/2BCD3411-E256-4ED0-BC39-B3D6CABF76AE_mw800_s.jpg'>
  <footer><p id='status'></p>
  2<p id='status2'></p></footer>
</body>
<script type='text/javascript'>
var button, timer, messageWrapper, statusWrapper;
document.getElementById('status').innerHTML = new Date().getTime();
require(['jquery', 'hybridge'],
function ($, Hybridge) {
messageWrapper = $('#message');
statusWrapper = $('#status');

statusWrapper.text(statusWrapper.text() + ' ' + new Date().getTime());

var processInit = function (event) {
statusWrapper.text('Hybridge (version ' + HybridgeGlobal.version + ') is ON');
Hybridge.removeListener(Hybridge.events.ready, processInit);
}

Hybridge.init({
'environment' : 'ios',
//'debug': 'true',
'mockResponses': {
'greetings': {
'response': 'ola moreno wapo'
}
}
});
//if (Hybridge.events["ready"]) {
Hybridge.addListener("ready", processInit);
//} else {
//statusWrapper.html('No Hybridge on the other side' + JSON.stringify(Hybridge.events));
//}
Hybridge.events.message && Hybridge.addListener(Hybridge.events.message, setResponse);

// Custom action
//

$('#button').click(function (ev) {
ev.preventDefault();
ev.stopPropagation();
button = ev.target;
messageWrapper.text('');
button.classList.add('loading');
button.setAttribute('disabled','disabled');
timer = setTimeout(function() {
button.classList.remove('loading');
button.removeAttribute('disabled');
statusWrapper.text('Something went wrong... Timeout!!');
},3000);

Hybridge.send({
'action': 'greetings',
'data': {
'myName': 'el yonatan'
}
})
.done(function (response) {
timer && clearTimeout (timer);
timer = null;
button.classList.remove('loading');
button.removeAttribute('disabled');
messageWrapper.text(JSON.stringify(response));
statusWrapper.text('');
});


});
}
);
</script>

</html>
